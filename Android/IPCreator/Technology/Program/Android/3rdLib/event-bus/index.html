<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon.ico">
  <link rel="mask-icon" href="/img/apple-touch-icon.png" color="#222">
  <link rel="alternate" href="/atom.xml" title="生命之旅" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-corner-indicator.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":true},
    copycode: {"enable":true,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: true,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},
    path: 'search.json',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="EventBus is an open-source library for Android using the publisher/subscriber pattern for loose coupling. EventBus enables central communication to decoupled classes with just a few lines of code – s">
<meta name="keywords" content="Third Library,Event Bus">
<meta property="og:type" content="article">
<meta property="og:title" content="EventBus——the  No.1 Open Source Event Library for Android">
<meta property="og:url" content="https://hazyman.com/Android/IPCreator/Technology/Program/Android/3rdLib/event-bus/index.html">
<meta property="og:site_name" content="生命之旅">
<meta property="og:description" content="EventBus is an open-source library for Android using the publisher/subscriber pattern for loose coupling. EventBus enables central communication to decoupled classes with just a few lines of code – s">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-03-29T15:30:38.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="EventBus——the  No.1 Open Source Event Library for Android">
<meta name="twitter:description" content="EventBus is an open-source library for Android using the publisher/subscriber pattern for loose coupling. EventBus enables central communication to decoupled classes with just a few lines of code – s">

<link rel="canonical" href="https://hazyman.com/Android/IPCreator/Technology/Program/Android/3rdLib/event-bus/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>EventBus——the  No.1 Open Source Event Library for Android | 生命之旅</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">生命之旅</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">常识、专业和价值。</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/IPCreator1833" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hazyman.com/Android/IPCreator/Technology/Program/Android/3rdLib/event-bus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/img/work-hard-life-easy.png">
      <meta itemprop="name" content="IPCreator">
      <meta itemprop="description" content="Life is a journey.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="生命之旅">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          EventBus——the  No.1 Open Source Event Library for Android
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/Android/IPCreator/Technology/Program/Android/3rdLib/event-bus/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/Android/IPCreator/Technology/Program/Android/3rdLib/event-bus/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img alt data-src="https://github.com/greenrobot/EventBus/raw/master/EventBus-Publish-Subscribe.png"></p>
<p>EventBus is an open-source library for Android using the publisher/subscriber pattern for loose coupling. EventBus enables central communication to decoupled classes with just a few lines of code – simplifying the code, removing dependencies, and speeding up app development.</p>
<a id="more"></a>
<h2 id="EventBus…"><a href="#EventBus…" class="headerlink" title="EventBus…"></a>EventBus…</h2><ul>
<li>simplifies the communication between components<ul>
<li>decouples event senders and receivers</li>
<li>performs well with Activities, Fragments, and background threads</li>
<li>avoids complex and error-prone dependencies and life cycle issues</li>
</ul>
</li>
<li>makes your code simpler</li>
<li>is fast</li>
<li>is tiny (~50k jar)</li>
<li>is proven in practice by apps with 100,000,000+ installs</li>
<li>has advanced features like delivery threads, subscriber priorities, etc.</li>
</ul>
<h2 id="EventBus-in-3-steps"><a href="#EventBus-in-3-steps" class="headerlink" title="EventBus in 3 steps"></a>EventBus in 3 steps</h2><h3 id="Step-1-Define-events"><a href="#Step-1-Define-events" class="headerlink" title="Step 1: Define events"></a>Step 1: Define events</h3><p> Events are POJO (plain old Java object) without any specific requirements.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class MessageEvent &#123;</span><br><span class="line"></span><br><span class="line">    public final String message;</span><br><span class="line"></span><br><span class="line">    public MessageEvent(String message) &#123;</span><br><span class="line">        this.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-2-Prepare-subscribers"><a href="#Step-2-Prepare-subscribers" class="headerlink" title="Step 2: Prepare subscribers"></a>Step 2: Prepare subscribers</h3><p> Subscribers implement event handling methods (also called “subscriber methods”) that will be called when an event is posted. These are defined with the @Subscribe annotation.</p>
<p> Note that with EventBus 3 the method name can be chosen freely (no naming conventions like in EventBus 2).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// This method will be called when a MessageEvent is posted (in the UI thread for Toast)</span><br><span class="line">@Subscribe(threadMode = ThreadMode.MAIN)</span><br><span class="line">public void onMessageEvent(MessageEvent event) &#123;</span><br><span class="line">    Toast.makeText(getActivity(), event.message, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// This method will be called when a SomeOtherEvent is posted</span><br><span class="line">@Subscribe</span><br><span class="line">public void handleSomethingElse(SomeOtherEvent event) &#123;</span><br><span class="line">    doSomethingWith(event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> Subscribers also need to register themselves to and unregister from the bus. Only while subscribers are registered, they will receive events. In Android, in activities and fragments you should usually register according to their life cycle. For most cases onStart/onStop works fine:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onStart() &#123;</span><br><span class="line">    super.onStart();</span><br><span class="line">    EventBus.getDefault().register(this);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void onStop() &#123;</span><br><span class="line">    EventBus.getDefault().unregister(this);</span><br><span class="line">    super.onStop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-3-Post-events"><a href="#Step-3-Post-events" class="headerlink" title="Step 3: Post events"></a>Step 3: Post events</h3><p> Post an event from any part of your code. All currently registered subscribers matching the event type will receive it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EventBus.getDefault().post(new MessageEvent(&quot;Hello everyone!&quot;));</span><br></pre></td></tr></table></figure>
<p><strong>Read the full <a href="http://greenrobot.org/eventbus/documentation/how-to-get-started/" target="_blank" rel="noopener">getting started guide</a>.</strong></p>
<h2 id="Add-EventBus-to-your-project"><a href="#Add-EventBus-to-your-project" class="headerlink" title="Add EventBus to your project"></a>Add EventBus to your project</h2><p>Please ensure that you are using the latest version by <a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.greenrobot%22%20AND%20a%3A%22eventbus%22" target="_blank" rel="noopener">checking here</a></p>
<p>Gradle:<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">compile</span> <span class="string">'org.greenrobot:eventbus:3.0.0'</span></span><br></pre></td></tr></table></figure></p>
<p>Maven:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.greenrobot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>eventbus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.greenrobot%22%20AND%20a%3A%22eventbus%22" target="_blank" rel="noopener">Or download EventBus from Maven Central</a></p>
<h2 id="Homepage-Documentation-Links"><a href="#Homepage-Documentation-Links" class="headerlink" title="Homepage, Documentation, Links"></a>Homepage, Documentation, Links</h2><p>For more details on EventBus please check <a href="http://greenrobot.org/eventbus" target="_blank" rel="noopener">EventBus’ website</a>. Here are some direct links you may find useful:</p>
<p><a href="http://greenrobot.org/eventbus/features/" target="_blank" rel="noopener">Features</a></p>
<p><a href="http://greenrobot.org/eventbus/documentation/" target="_blank" rel="noopener">Documentation</a></p>
<p><a href="http://greenrobot.org/eventbus/changelog/" target="_blank" rel="noopener">Changelog</a></p>
<p><a href="http://greenrobot.org/eventbus/documentation/faq/" target="_blank" rel="noopener">FAQ</a></p>
<p>How does EventBus compare to other solutions, like Otto from Square? Check this <a href="COMPARISON.md">comparison</a>.</p>
<h2 id="License"><a href="#License" class="headerlink" title="License"></a>License</h2><p>Copyright (C) 2012-2016 Markus Junginger, greenrobot (<a href="http://greenrobot.org" target="_blank" rel="noopener">http://greenrobot.org</a>)</p>
<p>EventBus binaries and source code can be used according to the <a href="LICENSE">Apache License, Version 2.0</a>.</p>
<h2 id="More-Open-Source-by-greenrobot"><a href="#More-Open-Source-by-greenrobot" class="headerlink" title="More Open Source by greenrobot"></a>More Open Source by greenrobot</h2><p><a href="https://github.com/greenrobot/greenrobot-common" target="_blank" rel="noopener"><strong>greenrobot-common</strong></a> is a set of utility classes and hash functions for Android &amp; Java projects.</p>
<p><a href="https://github.com/greenrobot/greenDAO" target="_blank" rel="noopener"><strong>greenDAO</strong></a> is an ORM optimized for Android: it maps database tables to Java objects and uses code generation for optimal speed.</p>
<p><a href="https://plus.google.com/b/114381455741141514652/+GreenrobotDe/posts" target="_blank" rel="noopener">Follow us on Google+</a> or check our <a href="http://greenrobot.org/" target="_blank" rel="noopener">homepage</a> to stay up to date.</p>
<h2 id="EventBus源码分析-3"><a href="#EventBus源码分析-3" class="headerlink" title="EventBus源码分析[3]"></a>EventBus源码分析<sup>[3]</sup></h2><p>EventBus的好处是显而易见的，完全解耦了请求链之间的关系，避免了请求者被长持有，又比广播更轻量，比LocalBroadcast则更强大，接口也简单实用。缺点的话，像是各种Event的定义是一个工作量。</p>
<h2 id="EventBus-otto-LocalBroadcast的选择-4"><a href="#EventBus-otto-LocalBroadcast的选择-4" class="headerlink" title="EventBus, otto, LocalBroadcast的选择[4]"></a>EventBus, otto, LocalBroadcast的选择<sup>[4]</sup></h2><ol>
<li>greenrobot的EventBus</li>
<li>square的otto</li>
<li>android support包里提供的LocalBroadcast</li>
</ol>
<p>三者都是类似订阅/发布的模式，降低了耦合度。与callback比起来，这种事件总线的模式使得两个类没有直接的依赖关系，对架构来说进行了解耦，把双向依赖变成了单向依赖，在大型项目中尤其显得重要。</p>
<h3 id="Why-publish-subscribe"><a href="#Why-publish-subscribe" class="headerlink" title="Why publish/subscribe"></a>Why publish/subscribe</h3><p>一方面，callback很容易产生内存泄露，如I/O、网络操作持有了Activity/Fragment的引用，导致不能及时释放，而团队中也很难保证每个成员都足够优秀在写callback的时候能使用弱引用或静态变量。相比起来订阅/发布者模式则比较简单，直接在BaseActivity的onDestroy释放掉，避免了可能的坑。</p>
<p>另外，从可扩展性、可维护性的角度来说，callback也更局限，比如以前某个接口是告诉上层网络数据拉回来了，现在我们希望扩展，这个接口也支持直接告诉上层数据库拉回来了，向上层屏蔽数据来源，如果用callback，则在一次回调结束后，没有办法再次进行回调了。页面必须自己去处理数据来源和拉数据的逻辑。</p>
<p>虽然有些over-architect的嫌疑，但是<a href="https://github.com/android10/Android-CleanArchitecture" target="_blank" rel="noopener">Android-CleanArchitecture</a> 确实是一种很clean的architecture，而其也正是通过观察者/订阅者模式来实现了单向依赖。</p>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><p>EventBus的github上就有其和otto的比较： <a href="https://github.com/greenrobot/EventBus/blob/master/COMPARISON.md" target="_blank" rel="noopener">EventBus vs Otto</a></p>
<p>总的来说，两者功能差的不多，otto多了Event producers (e.g. for coding cached events)，而EventBus则多了各种线程的处理、订阅者继承、sticky event等。</p>
<p>但从性能来说，由于otto使用了基于反射的annotation，而和EventBus产生了一定的差距（内部应该还有一些其他问题导致的性能差异，待研究）</p>
<p><strong>三者都不支持跨进程，LocalBroadcast内部其实使用的是Handler，所以其实更像是一个utils类。</strong></p>
<p>如果要做选择的话，LocalBroadcast更轻量，otto相比起api更好用，而EventBus则拥有很棒的线程模型，我投EventBus一票，因为onEvent的各种线程回调真的很方便。</p>
<h2 id="Android-Clean-Architecture-5"><a href="#Android-Clean-Architecture-5" class="headerlink" title="Android Clean Architecture[5]"></a>Android Clean Architecture<sup>[5]</sup></h2><h3 id="Clean-architecture"><a href="#Clean-architecture" class="headerlink" title="Clean architecture"></a>Clean architecture</h3><p><img alt data-src="https://github.com/android10/Sample-Data/raw/master/Android-CleanArchitecture/clean_architecture.png"></p>
<h3 id="Architectural-approach"><a href="#Architectural-approach" class="headerlink" title="Architectural approach"></a>Architectural approach</h3><p><img alt data-src="https://github.com/android10/Sample-Data/raw/master/Android-CleanArchitecture/clean_architecture_layers.png"></p>
<h3 id="Architectural-reactive-approach"><a href="#Architectural-reactive-approach" class="headerlink" title="Architectural reactive approach"></a>Architectural reactive approach</h3><p><img alt data-src="https://github.com/android10/Sample-Data/raw/master/Android-CleanArchitecture/clean_architecture_layers_details.png"></p>
<h2 id="应用MVP模式写出可维护的优美Android应用-6"><a href="#应用MVP模式写出可维护的优美Android应用-6" class="headerlink" title="应用MVP模式写出可维护的优美Android应用[6]"></a>应用MVP模式写出可维护的优美Android应用<sup>[6]</sup></h2><h3 id="MVP是什么"><a href="#MVP是什么" class="headerlink" title="MVP是什么"></a>MVP是什么</h3><p>MVP是MVC模式的一个衍生物，可以简单看下图。在MVP模式中，V层完全和M层（在Android中可能是Model、DAO、或者通用的business logic）分开。在中间用P层分隔，从而把数据有关和UI有关完全分离开。</p>
<p><img alt data-src="http://img.blog.csdn.net/20150627173920530"></p>
<h3 id="主流的MVP又有两种实现方式"><a href="#主流的MVP又有两种实现方式" class="headerlink" title="主流的MVP又有两种实现方式"></a>主流的MVP又有两种实现方式</h3><p>１）Activity、Fragment、View直接作为V层。Presenter通过继承被视图层实例化或者通过注入得到。这样Presenter在理想状态下可以完全和Android分离，也剥离了activity的那些生命周期。</p>
<p>2）Activity和Fragment作为P层，另外单独创建一个V层类，持有Activity里面的各种view，并提供接口让Activity调用来更新界面。</p>
<p>为了让V层和P层解耦，通常P层对V层的持有是通过interface的。</p>
<p>一个完整的mvp事件流可以是<br><img alt data-src="http://img.blog.csdn.net/20150627174025122"></p>
<h3 id="个人心得"><a href="#个人心得" class="headerlink" title="个人心得"></a>个人心得</h3><p>不要把presenter当做OnClickListener，View才是来处理用户输入和给予反馈的，presenter不应该知道view内部的逻辑来判断点击某个按钮后做出什么相应。一个简单的判断某个逻辑是否属于presenter的方法是，如果view层不是android，而是java桌面应用，那你的presenter层是不是还能不做更改地work。</p>
<p>view层只做presenter层让你做的，比如上图view层用户点了一个按钮，View调用了presenter.loadUsers，presenter一边在background thread去getUsers，一边调用了view.showLoading()，view层不该自说自话地showLoading。不过如何showLoading，比如展示怎么样的动画，那就是view层的内部矛盾了。</p>
<p>一个很大的好处，就是通过MVP，异步变得很清晰，view层的东西完全是主线程的，只需要等着presenter调就行了。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1]<a href="https://github.com/greenrobot/EventBus" target="_blank" rel="noopener">EventBus</a><br>[2]<a href="http://greenrobot.org/eventbus/documentation/how-to-get-started/" target="_blank" rel="noopener">How to get started with EventBus in 3 steps</a><br>[3]<a href="http://blog.zhaiyifan.cn/2015/08/20/EventBus-source/" target="_blank" rel="noopener">EventBus源码分析</a><br>[4]<a href="http://blog.zhaiyifan.cn/2015/08/17/EventBus:otto:LocalBroadcast%E7%9A%84%E9%80%89%E6%8B%A9/" target="_blank" rel="noopener">EventBus, otto, LocalBroadcast的选择</a><br>[5]<a href="https://github.com/android10/Android-CleanArchitecture" target="_blank" rel="noopener">Android-CleanArchitecture</a><br>[6]<a href="http://blog.zhaiyifan.cn/2015/06/01/use-mvp-to-write-nice-code/" target="_blank" rel="noopener">应用MVP模式写出可维护的优美Android应用</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Third-Library/" rel="tag"><i class="fa fa-tag"></i> Third Library</a>
              <a href="/tags/Event-Bus/" rel="tag"><i class="fa fa-tag"></i> Event Bus</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
                <a href="/Android/IPCreator/Technology/Program/Android/3rdLib/butterknife/" rel="next" title="Butter Knife——Field and method binding for Android views">
                  <i class="fa fa-chevron-left"></i> Butter Knife——Field and method binding for Android views
                </a>
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
                <a href="/Android/IPCreator/Technology/Program/Android/3rdLib/block-canary/" rel="prev" title="Block Canary——Android Performance Monitor">
                  Block Canary——Android Performance Monitor <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="comments"></div>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#EventBus…"><span class="nav-number">1.</span> <span class="nav-text">EventBus…</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EventBus-in-3-steps"><span class="nav-number">2.</span> <span class="nav-text">EventBus in 3 steps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-1-Define-events"><span class="nav-number">2.1.</span> <span class="nav-text">Step 1: Define events</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-2-Prepare-subscribers"><span class="nav-number">2.2.</span> <span class="nav-text">Step 2: Prepare subscribers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-3-Post-events"><span class="nav-number">2.3.</span> <span class="nav-text">Step 3: Post events</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Add-EventBus-to-your-project"><span class="nav-number">3.</span> <span class="nav-text">Add EventBus to your project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Homepage-Documentation-Links"><span class="nav-number">4.</span> <span class="nav-text">Homepage, Documentation, Links</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#License"><span class="nav-number">5.</span> <span class="nav-text">License</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#More-Open-Source-by-greenrobot"><span class="nav-number">6.</span> <span class="nav-text">More Open Source by greenrobot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EventBus源码分析-3"><span class="nav-number">7.</span> <span class="nav-text">EventBus源码分析[3]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EventBus-otto-LocalBroadcast的选择-4"><span class="nav-number">8.</span> <span class="nav-text">EventBus, otto, LocalBroadcast的选择[4]</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Why-publish-subscribe"><span class="nav-number">8.1.</span> <span class="nav-text">Why publish/subscribe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#比较"><span class="nav-number">8.2.</span> <span class="nav-text">比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android-Clean-Architecture-5"><span class="nav-number">9.</span> <span class="nav-text">Android Clean Architecture[5]</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Clean-architecture"><span class="nav-number">9.1.</span> <span class="nav-text">Clean architecture</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architectural-approach"><span class="nav-number">9.2.</span> <span class="nav-text">Architectural approach</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Architectural-reactive-approach"><span class="nav-number">9.3.</span> <span class="nav-text">Architectural reactive approach</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#应用MVP模式写出可维护的优美Android应用-6"><span class="nav-number">10.</span> <span class="nav-text">应用MVP模式写出可维护的优美Android应用[6]</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MVP是什么"><span class="nav-number">10.1.</span> <span class="nav-text">MVP是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#主流的MVP又有两种实现方式"><span class="nav-number">10.2.</span> <span class="nav-text">主流的MVP又有两种实现方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#个人心得"><span class="nav-number">10.3.</span> <span class="nav-text">个人心得</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">11.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="IPCreator"
    src="/img/work-hard-life-easy.png">
  <p class="site-author-name" itemprop="name">IPCreator</p>
  <div class="site-description" itemprop="description">Life is a journey.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1508</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">1443</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://blog.163.com/zhuxuanlv@126/" title="http://blog.163.com/zhuxuanlv@126/" rel="noopener" target="_blank">163 Blog</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">IPCreator</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">26.7m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">403:58</span>
</div>
  <div class="theme-info">主题 – <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.5.0
  </div>


<!-- 在网页底部添加网站运行时间 -->
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("03/24/2019 00:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = " "+dnum+" D ";
        document.getElementById("times").innerHTML = hnum + " H " + mnum + " M " + snum + " S";
    }
setInterval("createtime()",250);
</script>
        
<div class="busuanzi-count">
  <script pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      element.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  



  <script pjax>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id: 11184,
      el: 'wpac-rating',
      color: 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  <script src="/js/local-search.js"></script>












    <div id="pjax">

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: 'C75jI23HEPhTehiFhCvUSbJY-gzGzoHsz',
    appKey: 'qy3Id9srq8HBxwKg3CVSdNNq',
    placeholder: "Just go go",
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

    </div>

</body>
</html>
